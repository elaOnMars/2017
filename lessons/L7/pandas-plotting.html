

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-105019106-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced plotting with Pandas &mdash; Geo-Python 2017 Autumn documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/GeoPython_favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/geo-python.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Geo-Python 2017 Autumn documentation" href="../../index.html"/>
        <link rel="next" title="Exercise 7" href="ex-7.html"/>
        <link rel="prev" title="Connecting Matplotlib with plotly" href="using-plotly.html"/>
    <link href="../../_static/geo-python.css" rel="stylesheet" type="text/css">
     


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Geo-Python
          

          
            
            <img src="../../_static/logo_hy_geo_135.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2017 Autumn
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/course-info.html">General info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/learning-goals.html">Learning goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/grading.html">Grading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/installing-anacondas.html">Installing Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/python-vocabulary.html">Vocabulary - Basic terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/licensing.html">License and terms of usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L1/motivation.html">Motivation for the course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/course-environment-components.html">Course environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/intro-to-cloud-environment.html">Using the cloud computing environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/slack-usage.html">Communicating with Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/A-taste-of-Python.html">A taste of Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/exercise-1.html">Exercise 1</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L2/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/intro-to-GitHub.html">Introduction to Version Control and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/GitHub-classroom.html">Using Classroom for Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/working-on-assignment.html">Working on the assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/python-basic-elements.html">Basic elements of Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/writing-scripts.html">Writing your own Python scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/ex-2.html">Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/exercise-2-hints.html">Exercise 2 hints</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L3/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/for-loops.html"><code class="docutils literal"><span class="pre">for</span></code> loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/conditional-statements.html">Conditional statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/ex-3.html">Exercise 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/exercise-3-hints.html">Exercise 3 hints</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L4/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/modules.html">Loading and using modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/ex-4.html">Exercise 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/exercise-4-hints.html">Exercise 4 hints</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L5/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/pandas-overview.html">What is Pandas?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/pandas-basics.html">Exploring data using Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/pandas-basic-operations.html">Processing data with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/ex-5.html">Exercise 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/exercise-5-hints.html">Hints for Exercise 5</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 6</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L6/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L6/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L6/pandas-analysis.html">Advanced data processing with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L6/interpreting-errors.html">Dealing with errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L6/debugging-scripts.html">Debugging Python scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L6/ex-6.html">Exercise 6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L6/exercise-6-hints.html">Hints for Exercise 6</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 7</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="python-plotting.html">Plotting in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-anatomy.html">Anatomy of a plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="matplotlib.html">Plotting with Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-plotly.html">Connecting Matplotlib with plotly</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced plotting with Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#downloading-the-data-and-preparing">Downloading the data and preparing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parsing-datetime-when-reading-data">Parsing datetime when reading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-line-plot-in-pandas">Basic line plot in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-data-based-on-time-in-pandas">Selecting data based on time in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aggregating-data-with-resample-and-datetime-index">Aggregating data with <code class="docutils literal"><span class="pre">resample()</span></code> and datetime index</a></li>
<li class="toctree-l2"><a class="reference internal" href="#making-subplots">Making subplots</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex-7.html">Exercise 7</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-7-hints.html">Hints for Exercise 7</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Geo-Python</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Advanced plotting with Pandas</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/lessons/L7/pandas-plotting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-plotting-with-pandas">
<h1>Advanced plotting with Pandas<a class="headerlink" href="#advanced-plotting-with-pandas" title="Permalink to this headline">¶</a></h1>
<p>At this point you should know the basics of making plots with Matplotlib module. It is also possible to do Matplotlib plots directly
from Pandas because many of the basic functionalities of Matplotlib are integrated into Pandas.
In this part, we will show how to visualize data using Pandas and create plots such as this:</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/temp_plot2.png"><img alt="../../_images/temp_plot2.png" src="../../_images/temp_plot2.png" style="width: 600px;" /></a>
</div>
<div class="section" id="downloading-the-data-and-preparing">
<h2>Downloading the data and preparing<a class="headerlink" href="#downloading-the-data-and-preparing" title="Permalink to this headline">¶</a></h2>
<p>For our second lesson plotting data using Pandas we will use hourly weather data from Helsinki.
<strong>Download</strong> the <a class="reference external" href="../../_static/data/L7/1924927457196dat.txt">weather data file from here</a>.</p>
<blockquote>
<div><ul class="simple">
<li>Save a copy of this file in your home directory or a directory for the materials for this week&#8217;s lesson.</li>
<li>The data file contains observed hourly temperatures, windspeeds, etc. covering years 2012 and 2013. Observations were recorded from the Malmi airport weather station in Helsinki.
It is derived from a data file of daily temperature measurments downloaded from the <a class="reference external" href="https://www7.ncdc.noaa.gov/CDO/cdopoemain.cmd?datasetabbv=DS3505&amp;countryabbv=&amp;georegionabbv=&amp;resolution=40">US National Oceanographic and Atmospheric Administration&#8217;s National Centers for Environmental Information climate database</a>.</li>
<li>There should be around 16.5 thousand rows in the data.</li>
</ul>
</div></blockquote>
<p>The first rows of the data looks like following:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>  <span class="n">USAF</span>  <span class="n">WBAN</span> <span class="n">YR</span><span class="o">--</span><span class="n">MODAHRMN</span> <span class="n">DIR</span> <span class="n">SPD</span> <span class="n">GUS</span> <span class="n">CLG</span> <span class="n">SKC</span> <span class="n">L</span> <span class="n">M</span> <span class="n">H</span>  <span class="n">VSB</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">W</span> <span class="n">TEMP</span> <span class="n">DEWP</span>    <span class="n">SLP</span>   <span class="n">ALT</span>    <span class="n">STP</span> <span class="n">MAX</span> <span class="n">MIN</span> <span class="n">PCP01</span> <span class="n">PCP06</span> <span class="n">PCP24</span> <span class="n">PCPXX</span> <span class="n">SD</span>
<span class="mi">029750</span> <span class="mi">99999</span> <span class="mi">201201010050</span> <span class="mi">280</span>   <span class="mi">3</span> <span class="o">***</span>  <span class="mi">89</span> <span class="n">BKN</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">7.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">28</span>   <span class="mi">25</span> <span class="o">******</span> <span class="mf">29.74</span> <span class="o">******</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">**</span>
<span class="mi">029750</span> <span class="mi">99999</span> <span class="mi">201201010150</span> <span class="mi">310</span>   <span class="mi">3</span> <span class="o">***</span>  <span class="mi">89</span> <span class="n">OVC</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">7.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">27</span>   <span class="mi">25</span> <span class="o">******</span> <span class="mf">29.77</span> <span class="o">******</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">**</span>
<span class="mi">029750</span> <span class="mi">99999</span> <span class="mi">201201010250</span> <span class="mi">280</span>   <span class="mi">1</span> <span class="o">***</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">6.2</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">25</span>   <span class="mi">21</span> <span class="o">******</span> <span class="mf">29.77</span> <span class="o">******</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">**</span>
<span class="mi">029750</span> <span class="mi">99999</span> <span class="mi">201201010350</span> <span class="mi">200</span>   <span class="mi">1</span> <span class="o">***</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">6.2</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">21</span>   <span class="mi">21</span> <span class="o">******</span> <span class="mf">29.80</span> <span class="o">******</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">**</span>
</pre></div>
</div>
</div>
<div class="section" id="parsing-datetime-when-reading-data">
<h2>Parsing datetime when reading data<a class="headerlink" href="#parsing-datetime-when-reading-data" title="Permalink to this headline">¶</a></h2>
<p>One of the most useful and powerful features in Pandas is its ability to work with time data.
In Pandas, we can even read the data from a file and tell to Pandas that values from certain column should be
interpreted as time, and we can actually use that as our index, which is cool! You will see later why.</p>
<p>Let&#8217;s start by importing some modules that will be useful when plotting.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="gp">In [3]: </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="gp">In [4]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Next, let&#8217;s read the data into Pandas and determine that the values from <code class="docutils literal"><span class="pre">YR--MODAHRMN</span></code> column should be interpreted and converted into a time index.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;1924927457196dat.txt&quot;</span>
</pre></div>
</div>
<p>When reading the data we can use <code class="docutils literal"><span class="pre">parse_dates</span></code> parameter to parse the time information</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">],</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Let&#8217;s check the datatypes of our columns.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gh">Out[6]: </span><span class="go"></span>
<span class="go">USAF                     int64</span>
<span class="go">WBAN                     int64</span>
<span class="go">YR--MODAHRMN    datetime64[ns]</span>
<span class="go">DIR                    float64</span>
<span class="go">SPD                      int64</span>
<span class="go">GUS                    float64</span>
<span class="go">CLG                    float64</span>
<span class="go">SKC                     object</span>
<span class="go">L                      float64</span>
<span class="go">M                      float64</span>
<span class="go">H                      float64</span>
<span class="go">VSB                    float64</span>
<span class="go">MW                     float64</span>
<span class="go">MW.1                   float64</span>
<span class="go">MW.2                   float64</span>
<span class="go">MW.3                   float64</span>
<span class="go">AW                     float64</span>
<span class="go">AW.1                   float64</span>
<span class="go">AW.2                   float64</span>
<span class="go">AW.3                   float64</span>
<span class="go">W                      float64</span>
<span class="go">TEMP                   float64</span>
<span class="go">DEWP                   float64</span>
<span class="go">SLP                    float64</span>
<span class="go">ALT                    float64</span>
<span class="go">STP                    float64</span>
<span class="go">MAX                    float64</span>
<span class="go">MIN                    float64</span>
<span class="go">PCP01                  float64</span>
<span class="go">PCP06                  float64</span>
<span class="go">PCP24                  float64</span>
<span class="go">PCPXX                  float64</span>
<span class="go">SD                     float64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>As we can see the data type of <code class="docutils literal"><span class="pre">YR--MODAHRMN</span></code> column (third from above) is of type <code class="docutils literal"><span class="pre">datetime64[ns]</span></code>.
This means that the values on that column are interpreted as time objects.
Let&#8217;s see how our data look like.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[7]: </span><span class="go"></span>
<span class="go">    USAF   WBAN        YR--MODAHRMN    DIR  SPD  GUS   CLG  SKC   L   M ...  \</span>
<span class="go">0  29750  99999 2012-01-01 00:50:00  280.0    3  NaN  89.0  BKN NaN NaN ...   </span>
<span class="go">1  29750  99999 2012-01-01 01:50:00  310.0    3  NaN  89.0  OVC NaN NaN ...   </span>
<span class="go">2  29750  99999 2012-01-01 02:50:00  280.0    1  NaN   NaN  NaN NaN NaN ...   </span>
<span class="go">3  29750  99999 2012-01-01 03:50:00  200.0    1  NaN   NaN  NaN NaN NaN ...   </span>
<span class="go">4  29750  99999 2012-01-01 04:50:00    NaN    0  NaN   NaN  NaN NaN NaN ...   </span>

<span class="go">   SLP    ALT  STP  MAX  MIN  PCP01  PCP06  PCP24  PCPXX  SD  </span>
<span class="go">0  NaN  29.74  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN  </span>
<span class="go">1  NaN  29.77  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN  </span>
<span class="go">2  NaN  29.77  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN  </span>
<span class="go">3  NaN  29.80  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN  </span>
<span class="go">4  NaN  29.80  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN  </span>

<span class="go">[5 rows x 33 columns]</span>
</pre></div>
</div>
<p>As we can see the values on <code class="docutils literal"><span class="pre">YR--MODAHRMN</span></code> indeed look like time information where the first part represents the date (<code class="docutils literal"><span class="pre">yyyy-mm-dd</span></code>) and the second part represents the <code class="docutils literal"><span class="pre">hours:minutes:seconds</span></code>.</p>
<p>Before continue with plotting in Pandas, let&#8217;s process our data a bit by selecting only few columns, renaming them and converting the Fahrenheit temperatures into Celsius.
If you don&#8217;t remember how the following steps work, you might want to take another look on <a class="reference external" href="../L6/pandas-analysis.html#exploring-data-and-renaming-columns.html">Lesson 6 materials</a>.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Select data</span>
<span class="n">selected_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">selected_cols</span><span class="p">]</span>

<span class="c1"># Rename columns</span>
<span class="n">name_conversion</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">name_conversion</span><span class="p">)</span>

<span class="c1"># Convert Fahrenheit temperature into Celsius</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Celsius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.8</span>
</pre></div>
</div>
<p>Let&#8217;s confirm that everything looks correct.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[8]: </span><span class="go"></span>
<span class="go">                 TIME  TEMP  SPEED   Celsius</span>
<span class="go">0 2012-01-01 00:50:00  28.0      3 -2.222222</span>
<span class="go">1 2012-01-01 01:50:00  27.0      3 -2.777778</span>
<span class="go">2 2012-01-01 02:50:00  25.0      1 -3.888889</span>
<span class="go">3 2012-01-01 03:50:00  21.0      1 -6.111111</span>
<span class="go">4 2012-01-01 04:50:00  21.0      0 -6.111111</span>
</pre></div>
</div>
<p>Okey, great now our data looks better, and we can continue.
Let&#8217;s see how our data looks like by plotting the Celsius temperatures.</p>
</div>
<div class="section" id="basic-line-plot-in-pandas">
<h2>Basic line plot in Pandas<a class="headerlink" href="#basic-line-plot-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>In Pandas, it is extremely easy to plot data from your DataFrame. You can do this by using <code class="docutils literal"><span class="pre">plot()</span></code> function.
Let&#8217;s plot all the Celsius temperatures (y-axis) against the time (x-axis). You can specify the columns that you want to plot
with <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> parameters:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Celsius&#39;</span><span class="p">);</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/pandas_plot_1.png"><img alt="../../_images/pandas_plot_1.png" src="../../_images/pandas_plot_1.png" style="width: 450px;" /></a>
<p>Cool, it was this easy to produce a line plot that can be used to understand our data better.
We can clearly see that there is quite a lot of variation in the temperatures, and different seasons pop up quite clearly from the data.</p>
</div>
<div class="section" id="selecting-data-based-on-time-in-pandas">
<h2>Selecting data based on time in Pandas<a class="headerlink" href="#selecting-data-based-on-time-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>What is obvious from the figure above, is that the hourly level data is actually slightly too accurate for plotting data covering two full years.
Let&#8217;s see a trick, how we can really easily aggregate the data using Pandas.</p>
<p>First we need to set the <code class="docutils literal"><span class="pre">TIME</span></code> as the index of our DataFrame. We can do this by using <code class="docutils literal"><span class="pre">set_index()</span></code> parameter.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;TIME&#39;</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[11]: </span><span class="go"></span>
<span class="go">                     TEMP  SPEED   Celsius</span>
<span class="go">TIME                                      </span>
<span class="go">2012-01-01 00:50:00  28.0      3 -2.222222</span>
<span class="go">2012-01-01 01:50:00  27.0      3 -2.777778</span>
<span class="go">2012-01-01 02:50:00  25.0      1 -3.888889</span>
<span class="go">2012-01-01 03:50:00  21.0      1 -6.111111</span>
<span class="go">2012-01-01 04:50:00  21.0      0 -6.111111</span>
</pre></div>
</div>
<p>As we can see now the index of our data is not a sequential number from 0 up to 16569, but a <code class="docutils literal"><span class="pre">datetime</span> <span class="pre">index</span></code> that represents time.
What is cool about this thing is that you can really easily e.g. select data from a single day using basic Pandas indexing.</p>
<p>Let&#8217;s select data from first day of January in 2013 to demonstrate. We can slice the data by inserting the start date and end date that we want to include in our dataset.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">first_jan</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;2013-01-01&#39;</span><span class="p">:</span> <span class="s1">&#39;2013-01-01&#39;</span><span class="p">]</span>

<span class="gp">In [13]: </span><span class="n">first_jan</span>
<span class="gh">Out[13]: </span><span class="go"></span>
<span class="go">                     TEMP  SPEED   Celsius</span>
<span class="go">TIME                                      </span>
<span class="go">2013-01-01 00:50:00  34.0     13  1.111111</span>
<span class="go">2013-01-01 01:50:00  36.0     10  2.222222</span>
<span class="go">2013-01-01 02:50:00  36.0     10  2.222222</span>
<span class="go">2013-01-01 03:50:00  37.0     11  2.777778</span>
<span class="go">2013-01-01 04:50:00  37.0     13  2.777778</span>
<span class="go">2013-01-01 05:50:00  37.0     13  2.777778</span>
<span class="go">2013-01-01 06:50:00  37.0     11  2.777778</span>
<span class="go">2013-01-01 07:50:00  37.0     13  2.777778</span>
<span class="go">2013-01-01 08:50:00  37.0     11  2.777778</span>
<span class="go">2013-01-01 09:50:00  37.0     13  2.777778</span>
<span class="go">2013-01-01 10:50:00  37.0     15  2.777778</span>
<span class="go">2013-01-01 11:50:00  37.0     16  2.777778</span>
<span class="go">2013-01-01 12:50:00  37.0     16  2.777778</span>
<span class="go">2013-01-01 13:50:00  37.0     14  2.777778</span>
<span class="go">2013-01-01 14:50:00  37.0     11  2.777778</span>
<span class="go">2013-01-01 15:50:00  37.0     10  2.777778</span>
<span class="go">2013-01-01 16:50:00  37.0     11  2.777778</span>
<span class="go">2013-01-01 17:50:00  37.0     10  2.777778</span>
<span class="go">2013-01-01 18:50:00  37.0     10  2.777778</span>
<span class="go">2013-01-01 19:50:00  37.0     10  2.777778</span>
<span class="go">2013-01-01 20:50:00  37.0     10  2.777778</span>
<span class="go">2013-01-01 21:50:00  36.0     11  2.222222</span>
<span class="go">2013-01-01 22:50:00  36.0      9  2.222222</span>
<span class="go">2013-01-01 23:50:00  36.0      8  2.222222</span>
</pre></div>
</div>
<p>Cool! This is quite much easier to do than when parsing the date information using string manipulation (as we did on Lesson 6).
In a similar manner you can also specify more accurately the time that you want to select. Let&#8217;s now select only first 12 hours of the same day</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">first_jan_12h</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;2013-01-01 00:00&#39;</span><span class="p">:</span> <span class="s1">&#39;2013-01-01 12:00&#39;</span><span class="p">]</span>

<span class="gp">In [15]: </span><span class="n">first_jan_12h</span>
<span class="gh">Out[15]: </span><span class="go"></span>
<span class="go">                     TEMP  SPEED   Celsius</span>
<span class="go">TIME                                      </span>
<span class="go">2013-01-01 00:50:00  34.0     13  1.111111</span>
<span class="go">2013-01-01 01:50:00  36.0     10  2.222222</span>
<span class="go">2013-01-01 02:50:00  36.0     10  2.222222</span>
<span class="go">2013-01-01 03:50:00  37.0     11  2.777778</span>
<span class="go">2013-01-01 04:50:00  37.0     13  2.777778</span>
<span class="go">2013-01-01 05:50:00  37.0     13  2.777778</span>
<span class="go">2013-01-01 06:50:00  37.0     11  2.777778</span>
<span class="go">2013-01-01 07:50:00  37.0     13  2.777778</span>
<span class="go">2013-01-01 08:50:00  37.0     11  2.777778</span>
<span class="go">2013-01-01 09:50:00  37.0     13  2.777778</span>
<span class="go">2013-01-01 10:50:00  37.0     15  2.777778</span>
<span class="go">2013-01-01 11:50:00  37.0     16  2.777778</span>
</pre></div>
</div>
<p>Great. As we can see it is really easy to select data based on times as well.</p>
</div>
<div class="section" id="aggregating-data-with-resample-and-datetime-index">
<h2>Aggregating data with <code class="docutils literal"><span class="pre">resample()</span></code> and datetime index<a class="headerlink" href="#aggregating-data-with-resample-and-datetime-index" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s now continue with our original problem which was to aggregate the data into daily observations.
We can do this easily by using a <code class="docutils literal"><span class="pre">resample()</span></code> function that does the aggregation for us by utilizing our <code class="docutils literal"><span class="pre">datetime</span></code> index.
We can specify the <code class="docutils literal"><span class="pre">rule</span></code> how we aggregate the data. In below, we use <code class="docutils literal"><span class="pre">'D'</span></code> to specify that we want to aggregate our data based on <strong>Daily</strong> averages.
The last function in following command basically determines that we want to calculate the mean from our data values.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">daily</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="gp">In [17]: </span><span class="n">daily</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[17]: </span><span class="go"></span>
<span class="go">                 TEMP      SPEED   Celsius</span>
<span class="go">TIME                                      </span>
<span class="go">2012-01-01  25.250000   3.791667 -3.750000</span>
<span class="go">2012-01-02  33.130435  14.739130  0.628019</span>
<span class="go">2012-01-03  37.333333   6.333333  2.962963</span>
<span class="go">2012-01-04  37.041667  16.041667  2.800926</span>
<span class="go">2012-01-05  36.583333   8.541667  2.546296</span>
</pre></div>
</div>
<p>Awesome, now we have values on a daily level that we were able to aggregate with one simple command. Of course it is also possible to aggregate
based on multiple different time intervals such as hours (<code class="docutils literal"><span class="pre">H</span></code>), weeks (<code class="docutils literal"><span class="pre">W</span></code>) months (<code class="docutils literal"><span class="pre">M</span></code>), etc. See all possible aggregation types (=*offset aliases*) from <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html#offset-aliases">Pandas documentation</a></p>
<p>Let&#8217;s now plot our daily temperatures in a similar manner as earlier. Note, that now our time is the index of our DataFrame, so we can pass that into our plotting function. Let&#8217;s also change the width and the color of our line to red).
The <code class="docutils literal"><span class="pre">kind</span></code> parameter can be used to specify what kind of plot you want to visualize. There many different ones available in Pandas, however,
we will now only use basic line plots in this tutorial. See many different kind of plots from official <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/visualization.html">Pandas documentation about visualization</a>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">daily</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">daily</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Celsius&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/pandas_plot_2.png"><img alt="../../_images/pandas_plot_2.png" src="../../_images/pandas_plot_2.png" style="width: 600px;" /></a>
<p>Now we can see that our plot does not look so &#8220;crowded&#8221; as we have only daily observations instead of hourly.
What we can also see is that Pandas actually formats now the x-axis tick-labels really nicely (showing month names and years below them) because we are using the datetime-index to plot the data.</p>
<p>We can also save this figure to disk by using <code class="docutils literal"><span class="pre">plt.savefig()</span></code> function. With <code class="docutils literal"><span class="pre">dpi</span></code> parameter it is possible to specify the resolution of the Figure.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;temp_plot1.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In previous lesson, we did this by using string manipulation and grouping the data that are really useful skills, but the technique showed here,
is much more convenient way of producing the same result.</p>
</div>
</div>
<div class="section" id="making-subplots">
<h2>Making subplots<a class="headerlink" href="#making-subplots" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s continue working with the weather data and learn how to do subplots, i.e.
such Figures where you have multiple plots in different panels as was shown in the beginning.</p>
<p>Let&#8217;s start by changing our plotting style into a nicely looking <code class="docutils literal"><span class="pre">seaborn-whitegrid</span></code>.
You can take a look of different readily-available styles from <a class="reference external" href="https://tonysyu.github.io/raw_content/matplotlib-style-gallery/gallery.html">here</a> .</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s first divide our data into different seasons: Winter (December-February), Spring (March-May),
Summer (June-August), and Fall (Septempber-November).</p>
<p>We can do this really easily by selecting data based on the datetime index that we learned earlier.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="n">winter</span> <span class="o">=</span> <span class="n">daily</span><span class="p">[</span><span class="s1">&#39;2012-12-01&#39;</span><span class="p">:</span> <span class="s1">&#39;2013-02-28&#39;</span><span class="p">]</span>

<span class="gp">In [22]: </span><span class="n">spring</span> <span class="o">=</span> <span class="n">daily</span><span class="p">[</span><span class="s1">&#39;2013-03-01&#39;</span><span class="p">:</span> <span class="s1">&#39;2013-05-31&#39;</span><span class="p">]</span>

<span class="gp">In [23]: </span><span class="n">summer</span> <span class="o">=</span> <span class="n">daily</span><span class="p">[</span><span class="s1">&#39;2013-06-01&#39;</span><span class="p">:</span> <span class="s1">&#39;2013-08-31&#39;</span><span class="p">]</span>

<span class="gp">In [24]: </span><span class="n">fall</span> <span class="o">=</span> <span class="n">daily</span><span class="p">[</span><span class="s1">&#39;2013-09-01&#39;</span><span class="p">:</span> <span class="s1">&#39;2013-11-30&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Let&#8217;s check what we have e.g. in winter DataFrame now.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">winter</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[25]: </span><span class="go"></span>
<span class="go">                 TEMP     SPEED    Celsius</span>
<span class="go">TIME                                      </span>
<span class="go">2012-12-01  15.500000  6.083333  -9.166667</span>
<span class="go">2012-12-02  10.041667  3.416667 -12.199074</span>
<span class="go">2012-12-03  11.125000  3.791667 -11.597222</span>
<span class="go">2012-12-04  12.875000  5.750000 -10.625000</span>
<span class="go">2012-12-05  11.083333  3.791667 -11.620370</span>
</pre></div>
</div>
<p>We can plot them separately first, just to see how they look.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">winter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">winter</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Celsius&#39;</span><span class="p">);</span>

<span class="gp">In [27]: </span><span class="n">spring</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spring</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Celsius&#39;</span><span class="p">);</span>

<span class="gp">In [28]: </span><span class="n">summer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">summer</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Celsius&#39;</span><span class="p">);</span>

<span class="gp">In [29]: </span><span class="n">fall</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Celsius&#39;</span><span class="p">);</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/pandas_plot_3.png"><img alt="../../_images/pandas_plot_3.png" src="../../_images/pandas_plot_3.png" style="width: 280px;" /></a>
<a class="reference internal image-reference" href="../../_images/pandas_plot_4.png"><img alt="../../_images/pandas_plot_4.png" src="../../_images/pandas_plot_4.png" style="width: 280px;" /></a>
<a class="reference internal image-reference" href="../../_images/pandas_plot_5.png"><img alt="../../_images/pandas_plot_5.png" src="../../_images/pandas_plot_5.png" style="width: 280px;" /></a>
<a class="reference internal image-reference" href="../../_images/pandas_plot_6.png"><img alt="../../_images/pandas_plot_6.png" src="../../_images/pandas_plot_6.png" style="width: 280px;" /></a>
<p>Okey, so from these plots we can already see that the temperatures in different seasons are quite different, which is quite obvious of course.
It is important to notice that the scale of the y-axis changes in these different plots. If we would like to compare different seasons to each other
we need to make sure that the temperature scale is similar with all different seasons.</p>
<p>We want to have our y-axis limits so that the upper limit is the maximum temperature + 5 degrees
in our data (full year), and the lowest is the minimum temperature - 5 degrees, accordingly.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [30]: </span><span class="n">min_temp</span> <span class="o">=</span> <span class="n">daily</span><span class="p">[</span><span class="s1">&#39;Celsius&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">5</span>

<span class="gp">In [31]: </span><span class="n">max_temp</span> <span class="o">=</span> <span class="n">daily</span><span class="p">[</span><span class="s1">&#39;Celsius&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">5</span>

<span class="gp">In [32]: </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Min:&quot;</span><span class="p">,</span> <span class="n">min_temp</span><span class="p">,</span> <span class="s2">&quot;Max:&quot;</span><span class="p">,</span> <span class="n">max_temp</span><span class="p">)</span>
<span class="go">Min: -25.6481481481 Max: 29.0972222222</span>
</pre></div>
</div>
<p>Okey so we can see that the minimum temperature in our data is approximately -21 degrees and the maximum is +24 degrees.
We can now use those values to standardize the y-axis scale of our plot.</p>
<p>Let&#8217;s now continue and see how we can plot all these graphs different into the same Figure.
We can create a 2x2 panel for our visualization using matplotlib&#8217;s <code class="docutils literal"><span class="pre">subplots()</span></code> function where we specify how many rows and columns we want to have in our Figure.
We can also specify the size  of our figure with <code class="docutils literal"><span class="pre">figsize()</span></code> parameter that takes the <code class="docutils literal"><span class="pre">width</span></code> and <code class="docutils literal"><span class="pre">height</span></code> values (in inches) as input.&#8217;</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [33]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="gp">In [34]: </span><span class="n">axes</span>
<span class="gh">Out[34]: </span><span class="go"></span>
<span class="go">array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001DE0F432DD8&gt;,</span>
<span class="go">        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001DE10023668&gt;],</span>
<span class="go">       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001DE10075BE0&gt;,</span>
<span class="go">        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001DE100DD5F8&gt;]], dtype=object)</span>
</pre></div>
</div>
<p>We can see that as a result we have now a list containing two nested lists where the first one contains the axis for column 1 and 2 on <strong>row 1</strong>
and the second list contains the axis for columns 1 and 2 for <strong>row 2</strong>.
We can parse these axes into own variables so it is easier to work with them.&#8217;</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">ax11</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [36]: </span><span class="n">ax12</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [37]: </span><span class="n">ax21</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [38]: </span><span class="n">ax22</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Now we have four different axis variables for different panels in our Figure.
Next we can use them to plot the seasonal data into them.
Let&#8217;s first plot the seasons and give different colors for the lines, and specify the y-scale limits to be the same with all subplots.
With parameter <code class="docutils literal"><span class="pre">c</span></code> it is possible to specify the color of the line. You can find an extensive list of possible colors and RGB-color codes
from <a class="reference external" href="http://www.rapidtables.com/web/color/RGB_Color.htm">this link</a>. With <code class="docutils literal"><span class="pre">lw</span></code> parameter you can specify the width of the line.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">line_width</span> <span class="o">=</span> <span class="mf">2.5</span>

<span class="gp">In [40]: </span><span class="n">winter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">winter</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Celsius&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax11</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">min_temp</span><span class="p">,</span> <span class="n">max_temp</span><span class="p">));</span>

<span class="gp">In [41]: </span><span class="n">spring</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">spring</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Celsius&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">min_temp</span><span class="p">,</span> <span class="n">max_temp</span><span class="p">));</span>

<span class="gp">In [42]: </span><span class="n">summer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">summer</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Celsius&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax21</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">min_temp</span><span class="p">,</span> <span class="n">max_temp</span><span class="p">));</span>

<span class="gp">In [43]: </span><span class="n">fall</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fall</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Celsius&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax22</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">min_temp</span><span class="p">,</span> <span class="n">max_temp</span><span class="p">));</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/pandas_subplot_1.png"><img alt="../../_images/pandas_subplot_1.png" src="../../_images/pandas_subplot_1.png" style="width: 800px;" /></a>
</div>
<p>Great, now we have all the plots in same Figure! However, we can see that there are some problems with our x-axis as the number of ticks is different in different subplots.
We can change that. It is basically possible to adjust all elements of your visualization. Quite many of them can be adjusted
by referring to the <code class="docutils literal"><span class="pre">axis</span></code> object and modifying different parameters from there.</p>
<p>The following parts where we adjust the asthetics of the subplots might be a bit difficult to understand, but don&#8217;t worry if you don&#8217;t understand everything.
With other data types of data (other than time data) modifying e.g. the tick intervals is much easier.</p>
<p>Let&#8217;s first clean all the x-axis ticks. We can do that by going through all the axis and setting an empty list as ticks.
At the same time we can specify that the y-ticks should be visible every 5 degree intervals. For this purpose, we can take advantage of <code class="docutils literal"><span class="pre">arange()</span></code> function from numpy module. We can also set the size of our ticklabels larger at this point.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [44]: </span><span class="n">yticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mi">25</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">,</span> <span class="n">ax21</span><span class="p">,</span> <span class="n">ax22</span><span class="p">]:</span>
    <span class="c1"># Clear x axis ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
    <span class="c1"># Specifu y-axis ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
    <span class="c1"># Specify major tick-label sizes larger</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>Let&#8217;s specify that we want to have daily ticks for all our plots. This can be done by utilizing a specific functionality from matplotlib called <code class="docutils literal"><span class="pre">dates</span></code> that we can use to specify the ticks.
This part is quite advanced plotting, so again, do not worry if you don&#8217;t understand everything.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">dates</span>

<span class="c1"># Iterate over all four axes that we have and apply same procedures to each one of them</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">,</span> <span class="n">ax21</span><span class="p">,</span> <span class="n">ax22</span><span class="p">]:</span>
    <span class="c1"># Set minor ticks with day numbers</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">DayLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="c1"># Set major ticks with month names</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">%b&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/pandas_subplot_2.png"><img alt="../../_images/pandas_subplot_2.png" src="../../_images/pandas_subplot_2.png" style="width: 800px;" /></a>
</div>
<p>Perfect now we have similar scales for all of our subplots.</p>
<p>As a last step let&#8217;s add text on top of the plots to specify the seasons. Adding text on top of your plot
can be done easily with <code class="docutils literal"><span class="pre">text()</span></code> function. When using the <code class="docutils literal"><span class="pre">text()</span></code> function you need to specify (at least)
the x-position, y-position and the text which will be added to the plot.</p>
<p>Let&#8217;s specify the location for the Winter, Spring, Summer and Fall annotations.
In here, we can use the same y-position for all of our plots. However, with x-position we need to specify the position as
<code class="docutils literal"><span class="pre">datetime()</span></code> objects because the x-axis includes datetime values.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">all_y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">23</span>

<span class="gp">In [46]: </span><span class="n">wint_x</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="gp">In [47]: </span><span class="n">spr_x</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="gp">In [48]: </span><span class="n">sum_x</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="gp">In [49]: </span><span class="n">fal_x</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s add those texts on top of our subplots.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">ax11</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">wint_x</span><span class="p">,</span> <span class="n">all_y</span><span class="p">,</span> <span class="s1">&#39;Winter&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>

<span class="gp">In [51]: </span><span class="n">ax12</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">spr_x</span><span class="p">,</span> <span class="n">all_y</span><span class="p">,</span> <span class="s1">&#39;Spring&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>

<span class="gp">In [52]: </span><span class="n">ax21</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">sum_x</span><span class="p">,</span> <span class="n">all_y</span><span class="p">,</span> <span class="s1">&#39;Summer&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>

<span class="gp">In [53]: </span><span class="n">ax22</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">fal_x</span><span class="p">,</span> <span class="n">all_y</span><span class="p">,</span> <span class="s1">&#39;Fall&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
<p>Let&#8217;s add a common Y-label for the figure and a title, this can be done by adding another subplot that covers the area of the whole
Figure and adding labels on top of that.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [54]: </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span>
</pre></div>
</div>
<p>Let&#8217;s make sure that there are no ticks or labels added</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [55]: </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="gp">In [56]: </span><span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s now add common y-label and a title for our plot.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [57]: </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature in Celsius&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">);</span>

<span class="gp">In [58]: </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Seasonal variations in temperature&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>By calling <code class="docutils literal"><span class="pre">plt.tightlayout()</span></code> it is possible to remove most of the extra whitespace around your figure.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [59]: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, we can save our subplot to disk in a similar manner as before.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [60]: </span><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;Temperature_seasons_subplot.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/temp_plot2.png"><img alt="../../_images/temp_plot2.png" src="../../_images/temp_plot2.png" style="width: 800px;" /></a>
</div>
<p>And voilá! Now we have a fairly nice looking figure with four subplots. Now you know few really useful tricks
how to manipulate the aesthetics of your plot, and how to create subplots which is really useful skill to learn!
Now it is time to be creative and practice your visualization skills with an exercise.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ex-7.html" class="btn btn-neutral float-right" title="Exercise 7" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="using-plotly.html" class="btn btn-neutral" title="Connecting Matplotlib with plotly" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017 Tenkanen &amp; Whipp, University of Helsinki.
      Last updated on Oct 18, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p> <br/> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /> </a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2017 Autumn',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>