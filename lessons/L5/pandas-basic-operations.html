

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-105019106-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Processing data with Pandas &mdash; Geo-Python 2017 Autumn documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/GeoPython_favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/geo-python.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Geo-Python 2017 Autumn documentation" href="../../index.html"/>
        <link rel="next" title="Exercise 5" href="ex-5.html"/>
        <link rel="prev" title="Exploring data using Pandas" href="pandas-basics.html"/>
    <link href="../../_static/geo-python.css" rel="stylesheet" type="text/css">
     


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Geo-Python
          

          
            
            <img src="../../_static/logo_hy_geo_135.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2017 Autumn
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/course-info.html">General info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/learning-goals.html">Learning goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/grading.html">Grading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/installing-anacondas.html">Installing Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/python-vocabulary.html">Vocabulary - Basic terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/licensing.html">License and terms of usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L1/motivation.html">Motivation for the course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/course-environment-components.html">Course environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/intro-to-cloud-environment.html">Using the cloud computing environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/slack-usage.html">Communicating with Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/A-taste-of-Python.html">A taste of Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/exercise-1.html">Exercise 1</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L2/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/intro-to-GitHub.html">Introduction to Version Control and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/GitHub-classroom.html">Using Classroom for Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/working-on-assignment.html">Working on the assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/python-basic-elements.html">Basic elements of Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/writing-scripts.html">Writing your own Python scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/ex-2.html">Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/exercise-2-hints.html">Exercise 2 hints</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L3/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/for-loops.html"><code class="docutils literal"><span class="pre">for</span></code> loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/conditional-statements.html">Conditional statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/ex-3.html">Exercise 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/exercise-3-hints.html">Exercise 3 hints</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L4/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/modules.html">Loading and using modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/ex-4.html">Exercise 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/exercise-4-hints.html">Exercise 4 hints</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="pandas-overview.html">What is Pandas?</a></li>
<li class="toctree-l1"><a class="reference internal" href="pandas-basics.html">Exploring data using Pandas</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Processing data with Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#calculating-with-dataframes">Calculating with DataFrames</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-data-using-indices">Selecting data using indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering-and-updating-data">Filtering and updating data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dealing-with-missing-data">Dealing with missing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sorting-data">Sorting data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rounding-and-finding-unique-values">Rounding and finding unique values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-data">Writing data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex-5.html">Exercise 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-5-hints.html">Hints for Exercise 5</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Geo-Python</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Processing data with Pandas</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/lessons/L5/pandas-basic-operations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="processing-data-with-pandas">
<h1>Processing data with Pandas<a class="headerlink" href="#processing-data-with-pandas" title="Permalink to this headline">¶</a></h1>
<p>Now you should know the basics of the data structures in Pandas and how to explore your data using some tools that is provided by Pandas.
Next we continue to explore some of the basic data operations that are regularly needed when doing data analysis.</p>
<p>Let&#8217;s first read the same data as before into Pandas to have a clean start.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">dataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Kumpula-June-2016-w-metadata.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="calculating-with-dataframes">
<h2>Calculating with DataFrames<a class="headerlink" href="#calculating-with-dataframes" title="Permalink to this headline">¶</a></h2>
<p>One of the most common things to do in Pandas is to create new columns based on calculations between different variables (columns).</p>
<p>Creating a new column into our DataFrame is easy by specifying the name of the column and giving it some default value (in this case decimal number 0.0).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;DIFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="gp">In [2]: </span><span class="k">print</span><span class="p">(</span><span class="n">dataFrame</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF</span>
<span class="go">0   20160601  65.5  73.6  54.7   0.0</span>
<span class="go">1   20160602  65.8  80.8  55.0   0.0</span>
<span class="go">2   20160603  68.4  77.9  55.6   0.0</span>
<span class="go">3   20160604  57.5  70.9  47.3   0.0</span>
<span class="go">4   20160605  51.4  58.3  43.2   0.0</span>
<span class="go">5   20160606  52.2  59.7  42.8   0.0</span>
<span class="go">6   20160607  56.9  65.1  45.9   0.0</span>
<span class="go">7   20160608  54.2  60.4  47.5   0.0</span>
<span class="go">8   20160609  49.4  54.1  45.7   0.0</span>
<span class="go">9   20160610  49.5  55.9  43.0   0.0</span>
<span class="go">10  20160611  54.0  62.1  41.7   0.0</span>
<span class="go">11  20160612  55.4  64.2  46.0   0.0</span>
<span class="go">12  20160613  58.3  68.2  47.3   0.0</span>
<span class="go">13  20160614  59.7  67.8  47.8   0.0</span>
<span class="go">14  20160615  63.4  70.3  49.3   0.0</span>
<span class="go">15  20160616  57.8  67.5  55.6   0.0</span>
<span class="go">16  20160617  60.4  70.7  55.9   0.0</span>
<span class="go">17  20160618  57.3  62.8  54.0   0.0</span>
<span class="go">18  20160619  56.3  59.2  54.1   0.0</span>
<span class="go">19  20160620  59.3  69.1  52.2   0.0</span>
<span class="go">20  20160621  62.6  71.4  50.4   0.0</span>
<span class="go">21  20160622  61.7  70.2  55.4   0.0</span>
<span class="go">22  20160623  60.9  67.1  54.9   0.0</span>
<span class="go">23  20160624  61.1  68.9  56.7   0.0</span>
<span class="go">24  20160625  65.7  75.4  57.9   0.0</span>
<span class="go">25  20160626  69.6  77.7  60.3   0.0</span>
<span class="go">26  20160627  60.7  70.0  57.6   0.0</span>
<span class="go">27  20160628  65.4  73.0  55.8   0.0</span>
<span class="go">28  20160629  65.8  73.2  59.7   0.0</span>
<span class="go">29  20160630  65.7  72.7  59.2   0.0</span>
</pre></div>
</div>
<p>Let&#8217;s check the datatype of our new column</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;DIFF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gh">Out[3]: </span><span class="go">dtype(&#39;float64&#39;)</span>
</pre></div>
</div>
<p>Okey, so we see that Pandas created a new column and recognized automatically that the data type is float as we passed a 0.0 value to it.</p>
<p>We can also easily do calculations inside our DataFrame. Let&#8217;s update the column <code class="docutils literal"><span class="pre">DIFF</span></code> by calculating the difference between <code class="docutils literal"><span class="pre">MAX</span></code> and <code class="docutils literal"><span class="pre">MIN</span></code> columns to get an idea how much the temperatures have
been varying during different days. Calculations can be done with following syntax where we first specify the column that we want to update (i.e. <code class="docutils literal"><span class="pre">DIFF</span></code>) and then do the actual calculation
using the columns that we have in our dataFrameFrame.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;DIFF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;MAX&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;MIN&#39;</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="k">print</span><span class="p">(</span><span class="n">dataFrame</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF</span>
<span class="go">0   20160601  65.5  73.6  54.7  18.9</span>
<span class="go">1   20160602  65.8  80.8  55.0  25.8</span>
<span class="go">2   20160603  68.4  77.9  55.6  22.3</span>
<span class="go">3   20160604  57.5  70.9  47.3  23.6</span>
<span class="go">4   20160605  51.4  58.3  43.2  15.1</span>
<span class="go">5   20160606  52.2  59.7  42.8  16.9</span>
<span class="go">6   20160607  56.9  65.1  45.9  19.2</span>
<span class="go">7   20160608  54.2  60.4  47.5  12.9</span>
<span class="go">8   20160609  49.4  54.1  45.7   8.4</span>
<span class="go">9   20160610  49.5  55.9  43.0  12.9</span>
<span class="go">10  20160611  54.0  62.1  41.7  20.4</span>
<span class="go">11  20160612  55.4  64.2  46.0  18.2</span>
<span class="go">12  20160613  58.3  68.2  47.3  20.9</span>
<span class="go">13  20160614  59.7  67.8  47.8  20.0</span>
<span class="go">14  20160615  63.4  70.3  49.3  21.0</span>
<span class="go">15  20160616  57.8  67.5  55.6  11.9</span>
<span class="go">16  20160617  60.4  70.7  55.9  14.8</span>
<span class="go">17  20160618  57.3  62.8  54.0   8.8</span>
<span class="go">18  20160619  56.3  59.2  54.1   5.1</span>
<span class="go">19  20160620  59.3  69.1  52.2  16.9</span>
<span class="go">20  20160621  62.6  71.4  50.4  21.0</span>
<span class="go">21  20160622  61.7  70.2  55.4  14.8</span>
<span class="go">22  20160623  60.9  67.1  54.9  12.2</span>
<span class="go">23  20160624  61.1  68.9  56.7  12.2</span>
<span class="go">24  20160625  65.7  75.4  57.9  17.5</span>
<span class="go">25  20160626  69.6  77.7  60.3  17.4</span>
<span class="go">26  20160627  60.7  70.0  57.6  12.4</span>
<span class="go">27  20160628  65.4  73.0  55.8  17.2</span>
<span class="go">28  20160629  65.8  73.2  59.7  13.5</span>
<span class="go">29  20160630  65.7  72.7  59.2  13.5</span>
</pre></div>
</div>
<p>Okey so now we can see that the calculations were inserted into the <code class="docutils literal"><span class="pre">DIFF</span></code> column as planned. Notice that you can do calculations directly without first creating the column. Let&#8217;s test
this by calculating the difference between minimum temperature (<code class="docutils literal"><span class="pre">MIN</span></code>) and the mean temperature of the day (<code class="docutils literal"><span class="pre">TEMP</span></code>).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;DIFF_Min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;MIN&#39;</span><span class="p">]</span>

<span class="gp">In [7]: </span><span class="k">print</span><span class="p">(</span><span class="n">dataFrame</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min</span>
<span class="go">0   20160601  65.5  73.6  54.7  18.9      10.8</span>
<span class="go">1   20160602  65.8  80.8  55.0  25.8      10.8</span>
<span class="go">2   20160603  68.4  77.9  55.6  22.3      12.8</span>
<span class="go">3   20160604  57.5  70.9  47.3  23.6      10.2</span>
<span class="go">4   20160605  51.4  58.3  43.2  15.1       8.2</span>
<span class="go">5   20160606  52.2  59.7  42.8  16.9       9.4</span>
<span class="go">6   20160607  56.9  65.1  45.9  19.2      11.0</span>
<span class="go">7   20160608  54.2  60.4  47.5  12.9       6.7</span>
<span class="go">8   20160609  49.4  54.1  45.7   8.4       3.7</span>
<span class="go">9   20160610  49.5  55.9  43.0  12.9       6.5</span>
<span class="go">10  20160611  54.0  62.1  41.7  20.4      12.3</span>
<span class="go">11  20160612  55.4  64.2  46.0  18.2       9.4</span>
<span class="go">12  20160613  58.3  68.2  47.3  20.9      11.0</span>
<span class="go">13  20160614  59.7  67.8  47.8  20.0      11.9</span>
<span class="go">14  20160615  63.4  70.3  49.3  21.0      14.1</span>
<span class="go">15  20160616  57.8  67.5  55.6  11.9       2.2</span>
<span class="go">16  20160617  60.4  70.7  55.9  14.8       4.5</span>
<span class="go">17  20160618  57.3  62.8  54.0   8.8       3.3</span>
<span class="go">18  20160619  56.3  59.2  54.1   5.1       2.2</span>
<span class="go">19  20160620  59.3  69.1  52.2  16.9       7.1</span>
<span class="go">20  20160621  62.6  71.4  50.4  21.0      12.2</span>
<span class="go">21  20160622  61.7  70.2  55.4  14.8       6.3</span>
<span class="go">22  20160623  60.9  67.1  54.9  12.2       6.0</span>
<span class="go">23  20160624  61.1  68.9  56.7  12.2       4.4</span>
<span class="go">24  20160625  65.7  75.4  57.9  17.5       7.8</span>
<span class="go">25  20160626  69.6  77.7  60.3  17.4       9.3</span>
<span class="go">26  20160627  60.7  70.0  57.6  12.4       3.1</span>
<span class="go">27  20160628  65.4  73.0  55.8  17.2       9.6</span>
<span class="go">28  20160629  65.8  73.2  59.7  13.5       6.1</span>
<span class="go">29  20160630  65.7  72.7  59.2  13.5       6.5</span>
</pre></div>
</div>
<p>As you can see, now we created directly a new column with the calculation. In a similar manner, you can do calculations using as many columns as you need and using any kind of math
algebra (e.g. subtracttion, addition, multiplication, division, exponentiation, etc.).</p>
<p>We can for example convert the Fahrenheit temperatures in <code class="docutils literal"><span class="pre">TEMP</span></code> column into Celsius using the formula that we have seen already many times:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;TEMP_Celsius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">9</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="k">print</span><span class="p">(</span><span class="n">dataFrame</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">0   20160601  65.5  73.6  54.7  18.9      10.8     18.611111</span>
<span class="go">1   20160602  65.8  80.8  55.0  25.8      10.8     18.777778</span>
<span class="go">2   20160603  68.4  77.9  55.6  22.3      12.8     20.222222</span>
<span class="go">3   20160604  57.5  70.9  47.3  23.6      10.2     14.166667</span>
<span class="go">4   20160605  51.4  58.3  43.2  15.1       8.2     10.777778</span>
<span class="go">5   20160606  52.2  59.7  42.8  16.9       9.4     11.222222</span>
<span class="go">6   20160607  56.9  65.1  45.9  19.2      11.0     13.833333</span>
<span class="go">7   20160608  54.2  60.4  47.5  12.9       6.7     12.333333</span>
<span class="go">8   20160609  49.4  54.1  45.7   8.4       3.7      9.666667</span>
<span class="go">9   20160610  49.5  55.9  43.0  12.9       6.5      9.722222</span>
<span class="go">10  20160611  54.0  62.1  41.7  20.4      12.3     12.222222</span>
<span class="go">11  20160612  55.4  64.2  46.0  18.2       9.4     13.000000</span>
<span class="go">12  20160613  58.3  68.2  47.3  20.9      11.0     14.611111</span>
<span class="go">13  20160614  59.7  67.8  47.8  20.0      11.9     15.388889</span>
<span class="go">14  20160615  63.4  70.3  49.3  21.0      14.1     17.444444</span>
<span class="go">15  20160616  57.8  67.5  55.6  11.9       2.2     14.333333</span>
<span class="go">16  20160617  60.4  70.7  55.9  14.8       4.5     15.777778</span>
<span class="go">17  20160618  57.3  62.8  54.0   8.8       3.3     14.055556</span>
<span class="go">18  20160619  56.3  59.2  54.1   5.1       2.2     13.500000</span>
<span class="go">19  20160620  59.3  69.1  52.2  16.9       7.1     15.166667</span>
<span class="go">20  20160621  62.6  71.4  50.4  21.0      12.2     17.000000</span>
<span class="go">21  20160622  61.7  70.2  55.4  14.8       6.3     16.500000</span>
<span class="go">22  20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">23  20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">24  20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">25  20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
<span class="go">26  20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">27  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">28  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">29  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
</pre></div>
</div>
</div>
<div class="section" id="selecting-data-using-indices">
<h2>Selecting data using indices<a class="headerlink" href="#selecting-data-using-indices" title="Permalink to this headline">¶</a></h2>
<p>One quite common procedure in programming that you want to select only specific rows from your data and possibly apply some operations into those rows only.
In Pandas there are different ways of doing this.</p>
<p>One common way of selecting only specific rows from your DataFrame is done via <strong>index slicing</strong> to extract part of the DataFrame.</p>
<p>Let&#8217;s select the first five rows and assign them to a variable called <code class="docutils literal"><span class="pre">rows5</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">rows5</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [11]: </span><span class="k">print</span><span class="p">(</span><span class="n">rows5</span><span class="p">)</span>
<span class="go">   YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">0  20160601  65.5  73.6  54.7  18.9      10.8     18.611111</span>
<span class="go">1  20160602  65.8  80.8  55.0  25.8      10.8     18.777778</span>
<span class="go">2  20160603  68.4  77.9  55.6  22.3      12.8     20.222222</span>
<span class="go">3  20160604  57.5  70.9  47.3  23.6      10.2     14.166667</span>
<span class="go">4  20160605  51.4  58.3  43.2  15.1       8.2     10.777778</span>
</pre></div>
</div>
<p>As you can see, slicing is done in a similar manner as with normal Python lists, i.e. you specify index range you want to select inside the square brackets
<code class="docutils literal"><span class="pre">selection</span> <span class="pre">=</span> <span class="pre">dataFrame[start_index:stop_index]</span></code>.</p>
<p>You can also select an individual row from specific position using <code class="docutils literal"><span class="pre">.loc[]</span></code> indexing. Here we select all the data values from row 8.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">row8</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

<span class="gp">In [13]: </span><span class="k">print</span><span class="p">(</span><span class="n">row8</span><span class="p">)</span>
<span class="go">YEARMODA        2.016061e+07</span>
<span class="go">TEMP            4.940000e+01</span>
<span class="go">MAX             5.410000e+01</span>
<span class="go">MIN             4.570000e+01</span>
<span class="go">DIFF            8.400000e+00</span>
<span class="go">DIFF_Min        3.700000e+00</span>
<span class="go">TEMP_Celsius    9.666667e+00</span>
<span class="go">Name: 8, dtype: float64</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>Based on what we know about Python lists, what would you expect to see output from the following code?</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="last">Select your answer from the poll options at <a class="reference external" href="https://geo-python.github.io/poll/">https://geo-python.github.io/poll/</a>.</p>
</div>
<p><code class="docutils literal"><span class="pre">.loc[]</span></code> indexing returns the values from that position as a <code class="docutils literal"><span class="pre">pd.Series</span></code> where the indices are actually the column names of those variables. Hence, you can access the value of an individual column by referring to its index using following format (both should work):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="k">print</span><span class="p">(</span><span class="n">row8</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">])</span>
<span class="go">49.4</span>

<span class="gp">In [15]: </span><span class="k">print</span><span class="p">(</span><span class="n">row8</span><span class="o">.</span><span class="n">YEARMODA</span><span class="p">)</span>
<span class="go">     20160609.0</span>
</pre></div>
</div>
<p>It is also possible to select multiple rows simultaniously. Here, we select only temperature values (<code class="docutils literal"><span class="pre">TEMP</span></code>) between indices of 5-10:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">temps_5to10</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">]</span>

<span class="gp">In [17]: </span><span class="k">print</span><span class="p">(</span><span class="n">temps_5to10</span><span class="p">)</span>
<span class="go">5     52.2</span>
<span class="go">6     56.9</span>
<span class="go">7     54.2</span>
<span class="go">8     49.4</span>
<span class="go">9     49.5</span>
<span class="go">10    54.0</span>
<span class="go">Name: TEMP, dtype: float64</span>
</pre></div>
</div>
<p>It is also possible to select multiple columns using those same indices. Here, we select <code class="docutils literal"><span class="pre">TEMP</span></code> and the <code class="docutils literal"><span class="pre">TEMP_Celsius</span></code> columns by passing them inside a list (<code class="docutils literal"><span class="pre">.loc[start_index:stop_index,</span> <span class="pre">list_of_columns]</span></code>):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">temps_5to10</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_Celsius&#39;</span><span class="p">]]</span>

<span class="gp">In [19]: </span><span class="k">print</span><span class="p">(</span><span class="n">temps_5to10</span><span class="p">)</span>
<span class="go">    TEMP  TEMP_Celsius</span>
<span class="go">5   52.2     11.222222</span>
<span class="go">6   56.9     13.833333</span>
<span class="go">7   54.2     12.333333</span>
<span class="go">8   49.4      9.666667</span>
<span class="go">9   49.5      9.722222</span>
<span class="go">10  54.0     12.222222</span>
</pre></div>
</div>
<p>Of course, you can also get all values from those columns. This, can be done by simply referring to the dataFrame and inserting a list of columns inside the square brackets that you want to include.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">temps_only</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="p">[[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_Celsius&#39;</span><span class="p">]]</span>

<span class="gp">In [21]: </span><span class="k">print</span><span class="p">(</span><span class="n">temps_only</span><span class="p">)</span>
<span class="go">    TEMP  TEMP_Celsius</span>
<span class="go">0   65.5     18.611111</span>
<span class="go">1   65.8     18.777778</span>
<span class="go">2   68.4     20.222222</span>
<span class="go">3   57.5     14.166667</span>
<span class="go">4   51.4     10.777778</span>
<span class="go">5   52.2     11.222222</span>
<span class="go">6   56.9     13.833333</span>
<span class="go">7   54.2     12.333333</span>
<span class="go">8   49.4      9.666667</span>
<span class="go">9   49.5      9.722222</span>
<span class="go">10  54.0     12.222222</span>
<span class="go">11  55.4     13.000000</span>
<span class="go">12  58.3     14.611111</span>
<span class="go">13  59.7     15.388889</span>
<span class="go">14  63.4     17.444444</span>
<span class="go">15  57.8     14.333333</span>
<span class="go">16  60.4     15.777778</span>
<span class="go">17  57.3     14.055556</span>
<span class="go">18  56.3     13.500000</span>
<span class="go">19  59.3     15.166667</span>
<span class="go">20  62.6     17.000000</span>
<span class="go">21  61.7     16.500000</span>
<span class="go">22  60.9     16.055556</span>
<span class="go">23  61.1     16.166667</span>
<span class="go">24  65.7     18.722222</span>
<span class="go">25  69.6     20.888889</span>
<span class="go">26  60.7     15.944444</span>
<span class="go">27  65.4     18.555556</span>
<span class="go">28  65.8     18.777778</span>
<span class="go">29  65.7     18.722222</span>
</pre></div>
</div>
</div>
<div class="section" id="filtering-and-updating-data">
<h2>Filtering and updating data<a class="headerlink" href="#filtering-and-updating-data" title="Permalink to this headline">¶</a></h2>
<p>One really useful feature in Pandas is the ability to easily filter and select rows based on certain criteria using <code class="docutils literal"><span class="pre">.ix[]</span></code> indexing.
The following example shows how to select rows when the Celsius temperature has been higher than 15 degrees into variable <code class="docutils literal"><span class="pre">w_temps</span></code> (warm temperatures).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">w_temps</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;TEMP_Celsius&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">]</span>

<span class="gp">In [23]: </span><span class="k">print</span><span class="p">(</span><span class="n">w_temps</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">0   20160601  65.5  73.6  54.7  18.9      10.8     18.611111</span>
<span class="go">1   20160602  65.8  80.8  55.0  25.8      10.8     18.777778</span>
<span class="go">2   20160603  68.4  77.9  55.6  22.3      12.8     20.222222</span>
<span class="go">13  20160614  59.7  67.8  47.8  20.0      11.9     15.388889</span>
<span class="go">14  20160615  63.4  70.3  49.3  21.0      14.1     17.444444</span>
<span class="go">16  20160617  60.4  70.7  55.9  14.8       4.5     15.777778</span>
<span class="go">19  20160620  59.3  69.1  52.2  16.9       7.1     15.166667</span>
<span class="go">20  20160621  62.6  71.4  50.4  21.0      12.2     17.000000</span>
<span class="go">21  20160622  61.7  70.2  55.4  14.8       6.3     16.500000</span>
<span class="go">22  20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">23  20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">24  20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">25  20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
<span class="go">26  20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">27  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">28  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">29  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
</pre></div>
</div>
<p>It is also possible to combine multiple criteria at the same time. Here, we select temperatures above 15 degrees that were recorded on the second half of June in 2016 (i.e. <code class="docutils literal"><span class="pre">YEARMODA</span> <span class="pre">&gt;=</span> <span class="pre">20160615</span></code>).
Combining multiple criteria can be done with <code class="docutils literal"><span class="pre">&amp;</span></code> operator (AND) or <code class="docutils literal"><span class="pre">|</span></code> operator (OR). Notice, that it is often useful to separate the different clauses inside the parentheses <code class="docutils literal"><span class="pre">()</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">w_temps2</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="o">.</span><span class="n">ix</span><span class="p">[(</span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;TEMP_Celsius&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;YEARMODA&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">20160615</span><span class="p">)]</span>

<span class="gp">In [25]: </span><span class="k">print</span><span class="p">(</span><span class="n">w_temps2</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">14  20160615  63.4  70.3  49.3  21.0      14.1     17.444444</span>
<span class="go">16  20160617  60.4  70.7  55.9  14.8       4.5     15.777778</span>
<span class="go">19  20160620  59.3  69.1  52.2  16.9       7.1     15.166667</span>
<span class="go">20  20160621  62.6  71.4  50.4  21.0      12.2     17.000000</span>
<span class="go">21  20160622  61.7  70.2  55.4  14.8       6.3     16.500000</span>
<span class="go">22  20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">23  20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">24  20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">25  20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
<span class="go">26  20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">27  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">28  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">29  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
</pre></div>
</div>
<p>Now we have a subset of our DataFrame with only rows where the <code class="docutils literal"><span class="pre">TEMP_Celsius</span></code> is above 15 and the dates in <code class="docutils literal"><span class="pre">YEARMODA</span></code> column start from 15th of June.</p>
<p>Notice, that the index values (numbers on the left) are still showing the positions from the original DataFrame. It is possible to <strong>reset</strong> the index using <code class="docutils literal"><span class="pre">reset_index()</span></code> function that
might be useful in some cases to be able to slice the data in a similar manner as above. By default the <code class="docutils literal"><span class="pre">reset_index()</span></code> would make a new column called <code class="docutils literal"><span class="pre">index</span></code> to keep track on the previous
index which might be useful in some cases but here not, so we can omit that by passing parameter <code class="docutils literal"><span class="pre">drop=True</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">w_temps2</span> <span class="o">=</span> <span class="n">w_temps2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [27]: </span><span class="k">print</span><span class="p">(</span><span class="n">w_temps2</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">0   20160615  63.4  70.3  49.3  21.0      14.1     17.444444</span>
<span class="go">1   20160617  60.4  70.7  55.9  14.8       4.5     15.777778</span>
<span class="go">2   20160620  59.3  69.1  52.2  16.9       7.1     15.166667</span>
<span class="go">3   20160621  62.6  71.4  50.4  21.0      12.2     17.000000</span>
<span class="go">4   20160622  61.7  70.2  55.4  14.8       6.3     16.500000</span>
<span class="go">5   20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">6   20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">7   20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">8   20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
<span class="go">9   20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">10  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">11  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">12  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
</pre></div>
</div>
<p>As can be seen, now the index values goes from 0 to 12.</p>
</div>
<div class="section" id="dealing-with-missing-data">
<h2>Dealing with missing data<a class="headerlink" href="#dealing-with-missing-data" title="Permalink to this headline">¶</a></h2>
<p>Next we update the first five values of <code class="docutils literal"><span class="pre">TEMP_Celsius</span></code> in our <code class="docutils literal"><span class="pre">w_temps2</span></code> DataFrame to be <code class="docutils literal"><span class="pre">NaN</span></code> (not-a-number). This can be done by utilizing the <code class="docutils literal"><span class="pre">loc[]</span></code> indexing.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">w_temps2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;TEMP_Celsius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="gp">In [29]: </span><span class="k">print</span><span class="p">(</span><span class="n">w_temps2</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">0   20160615  63.4  70.3  49.3  21.0      14.1           NaN</span>
<span class="go">1   20160617  60.4  70.7  55.9  14.8       4.5           NaN</span>
<span class="go">2   20160620  59.3  69.1  52.2  16.9       7.1           NaN</span>
<span class="go">3   20160621  62.6  71.4  50.4  21.0      12.2           NaN</span>
<span class="go">4   20160622  61.7  70.2  55.4  14.8       6.3           NaN</span>
<span class="go">5   20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">6   20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">7   20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">8   20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
<span class="go">9   20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">10  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">11  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">12  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
</pre></div>
</div>
<p>Now we can see that we have some missing data in our DataFrame.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Notice here that you don&#8217;t necessary need to specify the starting index if you select data starting from the beginning of the file (at index 0), hence you can leave it empty as in the example above.</p>
</div>
<p>Having missing data in your datafile is really common situation and typically you want to deal with it somehow. Common procedures to deal with NaN is to either <strong>remove</strong> them from
the DataFrame or <strong>fill</strong> them with some value. In Pandas both of these options are really easy to do.</p>
<p>Let&#8217;s first see how we can remove the NoData values (i.e. clean the data) using <code class="docutils literal"><span class="pre">dropna()</span></code> function. Inside the function
you can pass with <code class="docutils literal"><span class="pre">subset</span></code> parameter a list of column(s) from which the NaN values should be searched from.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [30]: </span><span class="n">w_temps_clean</span> <span class="o">=</span> <span class="n">w_temps2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TEMP_Celsius&#39;</span><span class="p">])</span>

<span class="gp">In [31]: </span><span class="k">print</span><span class="p">(</span><span class="n">w_temps_clean</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">5   20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">6   20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">7   20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">8   20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
<span class="go">9   20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">10  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">11  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">12  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
</pre></div>
</div>
<p>As you can see, as a result we now have a DataFrame without the NoData values.</p>
<p>Other option is to fill the NoData with some value using <code class="docutils literal"><span class="pre">fillna()</span></code> -function. Here we fill it with value 0.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [32]: </span><span class="n">w_temps_na_filled</span> <span class="o">=</span> <span class="n">w_temps2</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [33]: </span><span class="k">print</span><span class="p">(</span><span class="n">w_temps_na_filled</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">0   20160615  63.4  70.3  49.3  21.0      14.1      0.000000</span>
<span class="go">1   20160617  60.4  70.7  55.9  14.8       4.5      0.000000</span>
<span class="go">2   20160620  59.3  69.1  52.2  16.9       7.1      0.000000</span>
<span class="go">3   20160621  62.6  71.4  50.4  21.0      12.2      0.000000</span>
<span class="go">4   20160622  61.7  70.2  55.4  14.8       6.3      0.000000</span>
<span class="go">5   20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">6   20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">7   20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">8   20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
<span class="go">9   20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">10  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">11  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">12  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
</pre></div>
</div>
<p>As a result we now have a DataFrame where NoData values are filled with value 0.00000.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In many cases filling the data with a specific value might be dangerous because you end up modifying the actual data that might affect the results of your analysis. For example in the example above
we would have dramatically changed the mean Celsius temperature because the 0 values are dramatically decreasing the average temperature of the month. Hence, use filling carefully.</p>
</div>
</div>
<div class="section" id="sorting-data">
<h2>Sorting data<a class="headerlink" href="#sorting-data" title="Permalink to this headline">¶</a></h2>
<p>Quite often it is useful to be able to sort your data (descending/ascending) based on values in some column
This can be easily done with Pandas using <code class="docutils literal"><span class="pre">sort_values(by='YourColumnName')</span></code> -function.</p>
<p>Let&#8217;s first sort the values on ascending order based on the <code class="docutils literal"><span class="pre">TEMP</span></code> column:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">sorted_temp_a</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;TEMP&#39;</span><span class="p">)</span>

<span class="gp">In [35]: </span><span class="k">print</span><span class="p">(</span><span class="n">sorted_temp_a</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">8   20160609  49.4  54.1  45.7   8.4       3.7      9.666667</span>
<span class="go">9   20160610  49.5  55.9  43.0  12.9       6.5      9.722222</span>
<span class="go">4   20160605  51.4  58.3  43.2  15.1       8.2     10.777778</span>
<span class="go">5   20160606  52.2  59.7  42.8  16.9       9.4     11.222222</span>
<span class="go">10  20160611  54.0  62.1  41.7  20.4      12.3     12.222222</span>
<span class="go">7   20160608  54.2  60.4  47.5  12.9       6.7     12.333333</span>
<span class="go">11  20160612  55.4  64.2  46.0  18.2       9.4     13.000000</span>
<span class="go">18  20160619  56.3  59.2  54.1   5.1       2.2     13.500000</span>
<span class="go">6   20160607  56.9  65.1  45.9  19.2      11.0     13.833333</span>
<span class="go">17  20160618  57.3  62.8  54.0   8.8       3.3     14.055556</span>
<span class="go">3   20160604  57.5  70.9  47.3  23.6      10.2     14.166667</span>
<span class="go">15  20160616  57.8  67.5  55.6  11.9       2.2     14.333333</span>
<span class="go">12  20160613  58.3  68.2  47.3  20.9      11.0     14.611111</span>
<span class="go">19  20160620  59.3  69.1  52.2  16.9       7.1     15.166667</span>
<span class="go">13  20160614  59.7  67.8  47.8  20.0      11.9     15.388889</span>
<span class="go">16  20160617  60.4  70.7  55.9  14.8       4.5     15.777778</span>
<span class="go">26  20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">22  20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">23  20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">21  20160622  61.7  70.2  55.4  14.8       6.3     16.500000</span>
<span class="go">20  20160621  62.6  71.4  50.4  21.0      12.2     17.000000</span>
<span class="go">14  20160615  63.4  70.3  49.3  21.0      14.1     17.444444</span>
<span class="go">27  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">0   20160601  65.5  73.6  54.7  18.9      10.8     18.611111</span>
<span class="go">24  20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">29  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
<span class="go">1   20160602  65.8  80.8  55.0  25.8      10.8     18.777778</span>
<span class="go">28  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">2   20160603  68.4  77.9  55.6  22.3      12.8     20.222222</span>
<span class="go">25  20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
</pre></div>
</div>
<p>Of course, it is also possible to sort them in descending order with <code class="docutils literal"><span class="pre">ascending=False</span></code> parameter:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [36]: </span><span class="n">sorted_temp_d</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [37]: </span><span class="k">print</span><span class="p">(</span><span class="n">sorted_temp_d</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius</span>
<span class="go">25  20160626  69.6  77.7  60.3  17.4       9.3     20.888889</span>
<span class="go">2   20160603  68.4  77.9  55.6  22.3      12.8     20.222222</span>
<span class="go">1   20160602  65.8  80.8  55.0  25.8      10.8     18.777778</span>
<span class="go">28  20160629  65.8  73.2  59.7  13.5       6.1     18.777778</span>
<span class="go">29  20160630  65.7  72.7  59.2  13.5       6.5     18.722222</span>
<span class="go">24  20160625  65.7  75.4  57.9  17.5       7.8     18.722222</span>
<span class="go">0   20160601  65.5  73.6  54.7  18.9      10.8     18.611111</span>
<span class="go">27  20160628  65.4  73.0  55.8  17.2       9.6     18.555556</span>
<span class="go">14  20160615  63.4  70.3  49.3  21.0      14.1     17.444444</span>
<span class="go">20  20160621  62.6  71.4  50.4  21.0      12.2     17.000000</span>
<span class="go">21  20160622  61.7  70.2  55.4  14.8       6.3     16.500000</span>
<span class="go">23  20160624  61.1  68.9  56.7  12.2       4.4     16.166667</span>
<span class="go">22  20160623  60.9  67.1  54.9  12.2       6.0     16.055556</span>
<span class="go">26  20160627  60.7  70.0  57.6  12.4       3.1     15.944444</span>
<span class="go">16  20160617  60.4  70.7  55.9  14.8       4.5     15.777778</span>
<span class="go">13  20160614  59.7  67.8  47.8  20.0      11.9     15.388889</span>
<span class="go">19  20160620  59.3  69.1  52.2  16.9       7.1     15.166667</span>
<span class="go">12  20160613  58.3  68.2  47.3  20.9      11.0     14.611111</span>
<span class="go">15  20160616  57.8  67.5  55.6  11.9       2.2     14.333333</span>
<span class="go">3   20160604  57.5  70.9  47.3  23.6      10.2     14.166667</span>
<span class="go">17  20160618  57.3  62.8  54.0   8.8       3.3     14.055556</span>
<span class="go">6   20160607  56.9  65.1  45.9  19.2      11.0     13.833333</span>
<span class="go">18  20160619  56.3  59.2  54.1   5.1       2.2     13.500000</span>
<span class="go">11  20160612  55.4  64.2  46.0  18.2       9.4     13.000000</span>
<span class="go">7   20160608  54.2  60.4  47.5  12.9       6.7     12.333333</span>
<span class="go">10  20160611  54.0  62.1  41.7  20.4      12.3     12.222222</span>
<span class="go">5   20160606  52.2  59.7  42.8  16.9       9.4     11.222222</span>
<span class="go">4   20160605  51.4  58.3  43.2  15.1       8.2     10.777778</span>
<span class="go">9   20160610  49.5  55.9  43.0  12.9       6.5      9.722222</span>
<span class="go">8   20160609  49.4  54.1  45.7   8.4       3.7      9.666667</span>
</pre></div>
</div>
</div>
<div class="section" id="rounding-and-finding-unique-values">
<h2>Rounding and finding unique values<a class="headerlink" href="#rounding-and-finding-unique-values" title="Permalink to this headline">¶</a></h2>
<p>It is possible to round values easily by using <code class="docutils literal"><span class="pre">round()</span></code> function. Here we round the Celsius temperatures with 0-decimals</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;Celsius_rounded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;TEMP_Celsius&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [39]: </span><span class="k">print</span><span class="p">(</span><span class="n">dataFrame</span><span class="p">)</span>
<span class="go">    YEARMODA  TEMP   MAX   MIN  DIFF  DIFF_Min  TEMP_Celsius  Celsius_rounded</span>
<span class="go">0   20160601  65.5  73.6  54.7  18.9      10.8     18.611111             19.0</span>
<span class="go">1   20160602  65.8  80.8  55.0  25.8      10.8     18.777778             19.0</span>
<span class="go">2   20160603  68.4  77.9  55.6  22.3      12.8     20.222222             20.0</span>
<span class="go">3   20160604  57.5  70.9  47.3  23.6      10.2     14.166667             14.0</span>
<span class="go">4   20160605  51.4  58.3  43.2  15.1       8.2     10.777778             11.0</span>
<span class="go">5   20160606  52.2  59.7  42.8  16.9       9.4     11.222222             11.0</span>
<span class="go">6   20160607  56.9  65.1  45.9  19.2      11.0     13.833333             14.0</span>
<span class="go">7   20160608  54.2  60.4  47.5  12.9       6.7     12.333333             12.0</span>
<span class="go">8   20160609  49.4  54.1  45.7   8.4       3.7      9.666667             10.0</span>
<span class="go">9   20160610  49.5  55.9  43.0  12.9       6.5      9.722222             10.0</span>
<span class="go">10  20160611  54.0  62.1  41.7  20.4      12.3     12.222222             12.0</span>
<span class="go">11  20160612  55.4  64.2  46.0  18.2       9.4     13.000000             13.0</span>
<span class="go">12  20160613  58.3  68.2  47.3  20.9      11.0     14.611111             15.0</span>
<span class="go">13  20160614  59.7  67.8  47.8  20.0      11.9     15.388889             15.0</span>
<span class="go">14  20160615  63.4  70.3  49.3  21.0      14.1     17.444444             17.0</span>
<span class="go">15  20160616  57.8  67.5  55.6  11.9       2.2     14.333333             14.0</span>
<span class="go">16  20160617  60.4  70.7  55.9  14.8       4.5     15.777778             16.0</span>
<span class="go">17  20160618  57.3  62.8  54.0   8.8       3.3     14.055556             14.0</span>
<span class="go">18  20160619  56.3  59.2  54.1   5.1       2.2     13.500000             13.0</span>
<span class="go">19  20160620  59.3  69.1  52.2  16.9       7.1     15.166667             15.0</span>
<span class="go">20  20160621  62.6  71.4  50.4  21.0      12.2     17.000000             17.0</span>
<span class="go">21  20160622  61.7  70.2  55.4  14.8       6.3     16.500000             16.0</span>
<span class="go">22  20160623  60.9  67.1  54.9  12.2       6.0     16.055556             16.0</span>
<span class="go">23  20160624  61.1  68.9  56.7  12.2       4.4     16.166667             16.0</span>
<span class="go">24  20160625  65.7  75.4  57.9  17.5       7.8     18.722222             19.0</span>
<span class="go">25  20160626  69.6  77.7  60.3  17.4       9.3     20.888889             21.0</span>
<span class="go">26  20160627  60.7  70.0  57.6  12.4       3.1     15.944444             16.0</span>
<span class="go">27  20160628  65.4  73.0  55.8  17.2       9.6     18.555556             19.0</span>
<span class="go">28  20160629  65.8  73.2  59.7  13.5       6.1     18.777778             19.0</span>
<span class="go">29  20160630  65.7  72.7  59.2  13.5       6.5     18.722222             19.0</span>
</pre></div>
</div>
<p>Now we have rounded our Celsius temperatures. Sometimes it is useful to extract the unique values that you have in your column.
We can do that by using <code class="docutils literal"><span class="pre">unique_values()</span></code> -function:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [40]: </span><span class="n">unique</span> <span class="o">=</span> <span class="n">dataFrame</span><span class="p">[</span><span class="s1">&#39;Celsius_rounded&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="gp">In [41]: </span><span class="n">unique</span>
<span class="gh">Out[41]: </span><span class="go">array([ 19.,  20.,  14.,  11.,  12.,  10.,  13.,  15.,  17.,  16.,  21.])</span>
</pre></div>
</div>
<p>As a result we get an array of unique values in that column.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Sometimes if you have a long list of unique values, you don&#8217;t necessary see all the unique values directly as IPython hides them. It is, however, possible to see all those values by printing them as a list:</p>
<div class="last highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">unique</span><span class="p">))</span>
<span class="go">[19.0, 20.0, 14.0, 11.0, 12.0, 10.0, 13.0, 15.0, 17.0, 16.0, 21.0]</span>
</pre></div>
</div>
</div>
<p>How many days with unique mean temperature did we have in June 2016? We can check that!</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [43]: </span><span class="n">uniq_temp_days</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">)</span>

<span class="gp">In [44]: </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;There were&quot;</span><span class="p">,</span> <span class="n">uniq_temp_days</span><span class="p">,</span> <span class="s2">&quot;days with unique mean temperatures in June 2016.&quot;</span><span class="p">)</span>
<span class="go">There were 11 days with unique mean temperatures in June 2016.</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-data">
<h2>Writing data<a class="headerlink" href="#writing-data" title="Permalink to this headline">¶</a></h2>
<p>Lastly, it is of course important to be able to write the data that you have analyzed into your computer. This is really handy in Pandas as it supports many different data formats
by default (<a class="reference external" href="pandas-overview.html#supports-data-read-write-from-multiple-formats">see more info here</a>).
The most typical output format by far is CSV file. Function <code class="docutils literal"><span class="pre">to_csv()</span></code> can be used to easily save your data in CSV format.</p>
<p>Let&#8217;s first save the data from our <code class="docutils literal"><span class="pre">data</span></code> DataFrame into a file called <code class="docutils literal"><span class="pre">Kumpula_temp_results_June_2016.csv</span></code> .</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">output_fp</span> <span class="o">=</span> <span class="s2">&quot;Kumpula_temps_June_2016.csv&quot;</span>

<span class="gp">In [46]: </span><span class="n">dataFrame</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_fp</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Nice, now we have the data from our DataFrame saved to a file:</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/pandas_save_file_result_1.PNG"><img alt="../../_images/pandas_save_file_result_1.PNG" src="../../_images/pandas_save_file_result_1.PNG" style="width: 500px;" /></a>
</div>
<p>As you can see, the first value in the datafile contains now the index value of the rows. There are also quite many decimals present in the new columns
that we created. Let&#8217;s deal with these and save the temperature values from <code class="docutils literal"><span class="pre">w_temps</span></code> DataFrame without the index and with only 1 decimal in the floating point numbers.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [47]: </span><span class="n">output_fp2</span> <span class="o">=</span> <span class="s2">&quot;Kumpula_temps_above15_June_2016.csv&quot;</span>

<span class="gp">In [48]: </span><span class="n">dataFrame</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_fp2</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Omitting the index can be with <code class="docutils literal"><span class="pre">index=False</span></code> parameter. Specifying how many decimals should be written can be done with <code class="docutils literal"><span class="pre">float_fomat</span></code> -parameter where text <code class="docutils literal"><span class="pre">%.1f</span></code> defines Pandas to use 1 decimals
in all columns when writing the data to a file (changing the value 1 to 2 would write 2 decimals etc.)</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/pandas_save_file_result_2.PNG"><img alt="../../_images/pandas_save_file_result_2.PNG" src="../../_images/pandas_save_file_result_2.PNG" style="width: 500px;" /></a>
</div>
<p>As a results you have a &#8220;cleaner&#8221; output file without the index column, and with only 1 decimal for floating point numbers.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p>It is quite common that people (especially non-programmers) want you to deliver data in MS Excel format. Saving DataFrame into Excel is also straightforward in Pandas.
First, you need to initialize a specific <code class="docutils literal"><span class="pre">ExcelWriter</span></code> object, and then you specify the filename and the spreadsheet name where you want to save the DataFrame.
Optionally, you can also omit the index and specify the float formatting as in our earlier examples:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [49]: </span><span class="n">excel_output_fp</span> <span class="o">=</span> <span class="s2">&quot;Kumpula_temps_June_2016.xlsx&quot;</span>

<span class="gp">In [50]: </span><span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">excel_output_fp</span><span class="p">)</span>

<span class="gp">In [51]: </span><span class="n">dataFrame</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Kumpula_temperatures&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As a result you have the DataFrame in Excel format:</p>
<div class="last figure">
<a class="reference internal image-reference" href="../../_images/pandas_save_excel_result_1.PNG"><img alt="../../_images/pandas_save_excel_result_1.PNG" src="../../_images/pandas_save_excel_result_1.PNG" style="width: 500px;" /></a>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ex-5.html" class="btn btn-neutral float-right" title="Exercise 5" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pandas-basics.html" class="btn btn-neutral" title="Exploring data using Pandas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017 Tenkanen &amp; Whipp, University of Helsinki.
      Last updated on Oct 06, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p> <br/> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /> </a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2017 Autumn',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>